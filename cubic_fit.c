#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "global.h"

double function(double ***coefficients, double x, double y, double z);

int cubic_interpolation(double ***in, double ***out, int *cell){

	double ***coefficients = create_3Darray(4,4,4);
	int i,j,k;
	double x,y,z;
	
	coefficients[0][0][0] = in[1][1][1];
	
	coefficients[0][0][1] = (-2*in[1][1][0]-3*in[1][1][1]+6*in[1][1][2]-in[1][1][3])/6;
	
	coefficients[0][0][2] = (in[1][1][0]-2*in[1][1][1]+in[1][1][2])/2;
	
	coefficients[0][0][3] = (-in[1][1][0]+3*in[1][1][1]-3*in[1][1][2]+in[1][1][3])/6;
	
	coefficients[0][1][0] = (-2*in[1][0][1]-3*in[1][1][1]+6*in[1][2][1]-in[1][3][1])/6;
	
	coefficients[0][1][1] = (4*in[1][0][0]+6*in[1][0][1]-12*in[1][0][2]+2*in[1][0][3]+6*in[1][1][0]+9*in[1][1][1]-
				18*in[1][1][2]+3*in[1][1][3]-12*in[1][2][0]-18*in[1][2][1]+36*in[1][2][2]-6*in[1][2][3]+
				2*in[1][3][0]+3*in[1][3][1]-6*in[1][3][2]+in[1][3][3])/36;
	
	coefficients[0][1][2] = (-2*in[1][0][0]+4*in[1][0][1]-2*in[1][0][2]-3*in[1][1][0]+6*in[1][1][1]-3*in[1][1][2]+
				6*in[1][2][0]-12*in[1][2][1]+6*in[1][2][2]-in[1][3][0]+2*in[1][3][1]-in[1][3][2])/12;
	
	coefficients[0][1][3] = (2*in[1][0][0]-6*in[1][0][1]+6*in[1][0][2]-2*in[1][0][3]+3*in[1][1][0]-9*in[1][1][1]+
				9*in[1][1][2]-3*in[1][1][3]-6*in[1][2][0]+18*in[1][2][1]-18*in[1][2][2]+6*in[1][2][3]+in[1][3][0]-
				3*in[1][3][1]+3*in[1][3][2]-in[1][3][3])/36;
	
	coefficients[0][2][0] = (in[1][0][1]-2*in[1][1][1]+in[1][2][1])/2;
	
	coefficients[0][2][1] = (-2*in[1][0][0]-3*in[1][0][1]+6*in[1][0][2]-in[1][0][3]+4*in[1][1][0]+6*in[1][1][1]-
				12*in[1][1][2]+2*in[1][1][3]-2*in[1][2][0]-3*in[1][2][1]+6*in[1][2][2]-in[1][2][3])/12;
	
	coefficients[0][2][2] = (in[1][0][0]-2*in[1][0][1]+in[1][0][2]-2*in[1][1][0]+4*in[1][1][1]-2*in[1][1][2]+in[1][2][0]-
				2*in[1][2][1]+in[1][2][2])/4;
	
	coefficients[0][2][3] = (-in[1][0][0]+3*in[1][0][1]-3*in[1][0][2]+in[1][0][3]+2*in[1][1][0]-6*in[1][1][1]+
				6*in[1][1][2]-2*in[1][1][3]-in[1][2][0]+3*in[1][2][1]-3*in[1][2][2]+in[1][2][3])/12;
	
	coefficients[0][3][0] = (-in[1][0][1]+3*in[1][1][1]-3*in[1][2][1]+in[1][3][1])/6;
	
	coefficients[0][3][1] = (2*in[1][0][0]+3*in[1][0][1]-6*in[1][0][2]+in[1][0][3]-6*in[1][1][0]-9*in[1][1][1]+
				18*in[1][1][2]-3*in[1][1][3]+6*in[1][2][0]+9*in[1][2][1]-18*in[1][2][2]+3*in[1][2][3]-
				2*in[1][3][0]-3*in[1][3][1]+6*in[1][3][2]-in[1][3][3])/36;
	
	coefficients[0][3][2] = (-in[1][0][0]+2*in[1][0][1]-in[1][0][2]+3*in[1][1][0]-6*in[1][1][1]+3*in[1][1][2]-
				3*in[1][2][0]+6*in[1][2][1]-3*in[1][2][2]+in[1][3][0]-2*in[1][3][1]+in[1][3][2])/12;
	
	coefficients[0][3][3] = (in[1][0][0]-3*in[1][0][1]+3*in[1][0][2]-in[1][0][3]-3*in[1][1][0]+9*in[1][1][1]-9*in[1][1][2]+
				3*in[1][1][3]+3*in[1][2][0]-9*in[1][2][1]+9*in[1][2][2]-3*in[1][2][3]-in[1][3][0]+3*in[1][3][1]-
				3*in[1][3][2]+in[1][3][3])/36;
	
	coefficients[1][0][0] = (-2*in[0][1][1]-3*in[1][1][1]+6*in[2][1][1]-in[3][1][1])/6;
	
	coefficients[1][0][1] = (4*in[0][1][0]+6*in[0][1][1]-12*in[0][1][2]+2*in[0][1][3]+6*in[1][1][0]+9*in[1][1][1]-
				18*in[1][1][2]+3*in[1][1][3]-12*in[2][1][0]-18*in[2][1][1]+36*in[2][1][2]-6*in[2][1][3]+
				2*in[3][1][0]+3*in[3][1][1]-6*in[3][1][2]+in[3][1][3])/36;
	
	coefficients[1][0][2] = (-2*in[0][1][0]+4*in[0][1][1]-2*in[0][1][2]-3*in[1][1][0]+6*in[1][1][1]-3*in[1][1][2]+
				6*in[2][1][0]-12*in[2][1][1]+6*in[2][1][2]-in[3][1][0]+2*in[3][1][1]-in[3][1][2])/12;
	
	coefficients[1][0][3] = (2*in[0][1][0]-6*in[0][1][1]+6*in[0][1][2]-2*in[0][1][3]+3*in[1][1][0]-9*in[1][1][1]+
				9*in[1][1][2]-3*in[1][1][3]-6*in[2][1][0]+18*in[2][1][1]-18*in[2][1][2]+6*in[2][1][3]+in[3][1][0]-
				3*in[3][1][1]+3*in[3][1][2]-in[3][1][3])/36;
	
	coefficients[1][1][0] = (4*in[0][0][1]+6*in[0][1][1]-12*in[0][2][1]+2*in[0][3][1]+6*in[1][0][1]+9*in[1][1][1]-
				18*in[1][2][1]+3*in[1][3][1]-12*in[2][0][1]-18*in[2][1][1]+36*in[2][2][1]-6*in[2][3][1]+
				2*in[3][0][1]+3*in[3][1][1]-6*in[3][2][1]+in[3][3][1])/36;
	
	coefficients[1][1][1] = (-8*in[0][0][0]-12*in[0][0][1]+24*in[0][0][2]-4*in[0][0][3]-12*in[0][1][0]-
				18*in[0][1][1]+36*in[0][1][2]-6*in[0][1][3]+24*in[0][2][0]+36*in[0][2][1]-72*in[0][2][2]+
				12*in[0][2][3]-4*in[0][3][0]-6*in[0][3][1]+12*in[0][3][2]-2*in[0][3][3]-12*in[1][0][0]-
				18*in[1][0][1]+36*in[1][0][2]-6*in[1][0][3]-18*in[1][1][0]-27*in[1][1][1]+54*in[1][1][2]-
				9*in[1][1][3]+36*in[1][2][0]+54*in[1][2][1]-108*in[1][2][2]+18*in[1][2][3]-6*in[1][3][0]-
				9*in[1][3][1]+18*in[1][3][2]-3*in[1][3][3]+24*in[2][0][0]+36*in[2][0][1]-72*in[2][0][2]+
				12*in[2][0][3]+36*in[2][1][0]+54*in[2][1][1]-108*in[2][1][2]+18*in[2][1][3]-72*in[2][2][0]-
				108*in[2][2][1]+216*in[2][2][2]-36*in[2][2][3]+12*in[2][3][0]+18*in[2][3][1]-36*in[2][3][2]+
				6*in[2][3][3]-4*in[3][0][0]-6*in[3][0][1]+12*in[3][0][2]-2*in[3][0][3]-6*in[3][1][0]-
				9*in[3][1][1]+18*in[3][1][2]-3*in[3][1][3]+12*in[3][2][0]+18*in[3][2][1]-36*in[3][2][2]+
				6*in[3][2][3]-2*in[3][3][0]-3*in[3][3][1]+6*in[3][3][2]-in[3][3][3])/216;
	
	coefficients[1][1][2] = (4*in[0][0][0]-8*in[0][0][1]+4*in[0][0][2]+6*in[0][1][0]-12*in[0][1][1]+6*in[0][1][2]-
				12*in[0][2][0]+24*in[0][2][1]-12*in[0][2][2]+2*in[0][3][0]-4*in[0][3][1]+2*in[0][3][2]+
				6*in[1][0][0]-12*in[1][0][1]+6*in[1][0][2]+9*in[1][1][0]-18*in[1][1][1]+9*in[1][1][2]-
				18*in[1][2][0]+36*in[1][2][1]-18*in[1][2][2]+3*in[1][3][0]-6*in[1][3][1]+3*in[1][3][2]-
				12*in[2][0][0]+24*in[2][0][1]-12*in[2][0][2]-18*in[2][1][0]+36*in[2][1][1]-18*in[2][1][2]+
				36*in[2][2][0]-72*in[2][2][1]+36*in[2][2][2]-6*in[2][3][0]+12*in[2][3][1]-6*in[2][3][2]+
				2*in[3][0][0]-4*in[3][0][1]+2*in[3][0][2]+3*in[3][1][0]-6*in[3][1][1]+3*in[3][1][2]-6*in[3][2][0]+
				12*in[3][2][1]-6*in[3][2][2]+in[3][3][0]-2*in[3][3][1]+in[3][3][2])/72;
	
	coefficients[1][1][3] = (-4*in[0][0][0]+12*in[0][0][1]-12*in[0][0][2]+4*in[0][0][3]-6*in[0][1][0]+
				18*in[0][1][1]-18*in[0][1][2]+6*in[0][1][3]+12*in[0][2][0]-36*in[0][2][1]+36*in[0][2][2]-
				12*in[0][2][3]-2*in[0][3][0]+6*in[0][3][1]-6*in[0][3][2]+2*in[0][3][3]-6*in[1][0][0]+
				18*in[1][0][1]-18*in[1][0][2]+6*in[1][0][3]-9*in[1][1][0]+27*in[1][1][1]-27*in[1][1][2]+
				9*in[1][1][3]+18*in[1][2][0]-54*in[1][2][1]+54*in[1][2][2]-18*in[1][2][3]-3*in[1][3][0]+
				9*in[1][3][1]-9*in[1][3][2]+3*in[1][3][3]+12*in[2][0][0]-36*in[2][0][1]+36*in[2][0][2]-
				12*in[2][0][3]+18*in[2][1][0]-54*in[2][1][1]+54*in[2][1][2]-18*in[2][1][3]-36*in[2][2][0]+
				108*in[2][2][1]-108*in[2][2][2]+36*in[2][2][3]+6*in[2][3][0]-18*in[2][3][1]+18*in[2][3][2]-
				6*in[2][3][3]-2*in[3][0][0]+6*in[3][0][1]-6*in[3][0][2]+2*in[3][0][3]-3*in[3][1][0]+9*in[3][1][1]-
				9*in[3][1][2]+3*in[3][1][3]+6*in[3][2][0]-18*in[3][2][1]+18*in[3][2][2]-6*in[3][2][3]-in[3][3][0]+
				3*in[3][3][1]-3*in[3][3][2]+in[3][3][3])/216;
	
	coefficients[1][2][0] = (-2*in[0][0][1]+4*in[0][1][1]-2*in[0][2][1]-3*in[1][0][1]+6*in[1][1][1]-3*in[1][2][1]+
				6*in[2][0][1]-12*in[2][1][1]+6*in[2][2][1]-in[3][0][1]+2*in[3][1][1]-in[3][2][1])/12;
	
	coefficients[1][2][1] = (4*in[0][0][0]+6*in[0][0][1]-12*in[0][0][2]+2*in[0][0][3]-8*in[0][1][0]-12*in[0][1][1]+
				24*in[0][1][2]-4*in[0][1][3]+4*in[0][2][0]+6*in[0][2][1]-12*in[0][2][2]+2*in[0][2][3]+
				6*in[1][0][0]+9*in[1][0][1]-18*in[1][0][2]+3*in[1][0][3]-12*in[1][1][0]-18*in[1][1][1]+
				36*in[1][1][2]-6*in[1][1][3]+6*in[1][2][0]+9*in[1][2][1]-18*in[1][2][2]+3*in[1][2][3]-
				12*in[2][0][0]-18*in[2][0][1]+36*in[2][0][2]-6*in[2][0][3]+24*in[2][1][0]+36*in[2][1][1]-
				72*in[2][1][2]+12*in[2][1][3]-12*in[2][2][0]-18*in[2][2][1]+36*in[2][2][2]-6*in[2][2][3]+
				2*in[3][0][0]+3*in[3][0][1]-6*in[3][0][2]+in[3][0][3]-4*in[3][1][0]-6*in[3][1][1]+12*in[3][1][2]-
				2*in[3][1][3]+2*in[3][2][0]+3*in[3][2][1]-6*in[3][2][2]+in[3][2][3])/72;
	
	coefficients[1][2][2] = (-2*in[0][0][0]+4*in[0][0][1]-2*in[0][0][2]+4*in[0][1][0]-8*in[0][1][1]+4*in[0][1][2]-
				2*in[0][2][0]+4*in[0][2][1]-2*in[0][2][2]-3*in[1][0][0]+6*in[1][0][1]-3*in[1][0][2]+6*in[1][1][0]-
				12*in[1][1][1]+6*in[1][1][2]-3*in[1][2][0]+6*in[1][2][1]-3*in[1][2][2]+6*in[2][0][0]-
				12*in[2][0][1]+6*in[2][0][2]-12*in[2][1][0]+24*in[2][1][1]-12*in[2][1][2]+6*in[2][2][0]-
				12*in[2][2][1]+6*in[2][2][2]-in[3][0][0]+2*in[3][0][1]-in[3][0][2]+2*in[3][1][0]-4*in[3][1][1]+
				2*in[3][1][2]-in[3][2][0]+2*in[3][2][1]-in[3][2][2])/24;
	
	coefficients[1][2][3] = (2*in[0][0][0]-6*in[0][0][1]+6*in[0][0][2]-2*in[0][0][3]-4*in[0][1][0]+12*in[0][1][1]-
				12*in[0][1][2]+4*in[0][1][3]+2*in[0][2][0]-6*in[0][2][1]+6*in[0][2][2]-2*in[0][2][3]+
				3*in[1][0][0]-9*in[1][0][1]+9*in[1][0][2]-3*in[1][0][3]-6*in[1][1][0]+18*in[1][1][1]-
				18*in[1][1][2]+6*in[1][1][3]+3*in[1][2][0]-9*in[1][2][1]+9*in[1][2][2]-3*in[1][2][3]-
				6*in[2][0][0]+18*in[2][0][1]-18*in[2][0][2]+6*in[2][0][3]+12*in[2][1][0]-36*in[2][1][1]+
				36*in[2][1][2]-12*in[2][1][3]-6*in[2][2][0]+18*in[2][2][1]-18*in[2][2][2]+6*in[2][2][3]+
				in[3][0][0]-3*in[3][0][1]+3*in[3][0][2]-in[3][0][3]-2*in[3][1][0]+6*in[3][1][1]-6*in[3][1][2]+
				2*in[3][1][3]+in[3][2][0]-3*in[3][2][1]+3*in[3][2][2]-in[3][2][3])/72;
	
	coefficients[1][3][0] = (2*in[0][0][1]-6*in[0][1][1]+6*in[0][2][1]-2*in[0][3][1]+3*in[1][0][1]-9*in[1][1][1]+
				9*in[1][2][1]-3*in[1][3][1]-6*in[2][0][1]+18*in[2][1][1]-18*in[2][2][1]+6*in[2][3][1]+in[3][0][1]-
				3*in[3][1][1]+3*in[3][2][1]-in[3][3][1])/36;
	
	coefficients[1][3][1] = (-4*in[0][0][0]-6*in[0][0][1]+12*in[0][0][2]-2*in[0][0][3]+12*in[0][1][0]+
				18*in[0][1][1]-36*in[0][1][2]+6*in[0][1][3]-12*in[0][2][0]-18*in[0][2][1]+36*in[0][2][2]-
				6*in[0][2][3]+4*in[0][3][0]+6*in[0][3][1]-12*in[0][3][2]+2*in[0][3][3]-6*in[1][0][0]-
				9*in[1][0][1]+18*in[1][0][2]-3*in[1][0][3]+18*in[1][1][0]+27*in[1][1][1]-54*in[1][1][2]+
				9*in[1][1][3]-18*in[1][2][0]-27*in[1][2][1]+54*in[1][2][2]-9*in[1][2][3]+6*in[1][3][0]+
				9*in[1][3][1]-18*in[1][3][2]+3*in[1][3][3]+12*in[2][0][0]+18*in[2][0][1]-36*in[2][0][2]+
				6*in[2][0][3]-36*in[2][1][0]-54*in[2][1][1]+108*in[2][1][2]-18*in[2][1][3]+36*in[2][2][0]+
				54*in[2][2][1]-108*in[2][2][2]+18*in[2][2][3]-12*in[2][3][0]-18*in[2][3][1]+36*in[2][3][2]-
				6*in[2][3][3]-2*in[3][0][0]-3*in[3][0][1]+6*in[3][0][2]-in[3][0][3]+6*in[3][1][0]+9*in[3][1][1]-
				18*in[3][1][2]+3*in[3][1][3]-6*in[3][2][0]-9*in[3][2][1]+18*in[3][2][2]-3*in[3][2][3]+
				2*in[3][3][0]+3*in[3][3][1]-6*in[3][3][2]+in[3][3][3])/216;
	
	coefficients[1][3][2] = (2*in[0][0][0]-4*in[0][0][1]+2*in[0][0][2]-6*in[0][1][0]+12*in[0][1][1]-6*in[0][1][2]+
				6*in[0][2][0]-12*in[0][2][1]+6*in[0][2][2]-2*in[0][3][0]+4*in[0][3][1]-2*in[0][3][2]+
				3*in[1][0][0]-6*in[1][0][1]+3*in[1][0][2]-9*in[1][1][0]+18*in[1][1][1]-9*in[1][1][2]+
				9*in[1][2][0]-18*in[1][2][1]+9*in[1][2][2]-3*in[1][3][0]+6*in[1][3][1]-3*in[1][3][2]-
				6*in[2][0][0]+12*in[2][0][1]-6*in[2][0][2]+18*in[2][1][0]-36*in[2][1][1]+18*in[2][1][2]-
				18*in[2][2][0]+36*in[2][2][1]-18*in[2][2][2]+6*in[2][3][0]-12*in[2][3][1]+6*in[2][3][2]+
				in[3][0][0]-2*in[3][0][1]+in[3][0][2]-3*in[3][1][0]+6*in[3][1][1]-3*in[3][1][2]+3*in[3][2][0]-
				6*in[3][2][1]+3*in[3][2][2]-in[3][3][0]+2*in[3][3][1]-in[3][3][2])/72;
	
	coefficients[1][3][3] = (-2*in[0][0][0]+6*in[0][0][1]-6*in[0][0][2]+2*in[0][0][3]+6*in[0][1][0]-
				18*in[0][1][1]+18*in[0][1][2]-6*in[0][1][3]-6*in[0][2][0]+18*in[0][2][1]-18*in[0][2][2]+
				6*in[0][2][3]+2*in[0][3][0]-6*in[0][3][1]+6*in[0][3][2]-2*in[0][3][3]-3*in[1][0][0]+9*in[1][0][1]-
				9*in[1][0][2]+3*in[1][0][3]+9*in[1][1][0]-27*in[1][1][1]+27*in[1][1][2]-9*in[1][1][3]-
				9*in[1][2][0]+27*in[1][2][1]-27*in[1][2][2]+9*in[1][2][3]+3*in[1][3][0]-9*in[1][3][1]+
				9*in[1][3][2]-3*in[1][3][3]+6*in[2][0][0]-18*in[2][0][1]+18*in[2][0][2]-6*in[2][0][3]-
				18*in[2][1][0]+54*in[2][1][1]-54*in[2][1][2]+18*in[2][1][3]+18*in[2][2][0]-54*in[2][2][1]+
				54*in[2][2][2]-18*in[2][2][3]-6*in[2][3][0]+18*in[2][3][1]-18*in[2][3][2]+6*in[2][3][3]-
				in[3][0][0]+3*in[3][0][1]-3*in[3][0][2]+in[3][0][3]+3*in[3][1][0]-9*in[3][1][1]+9*in[3][1][2]-
				3*in[3][1][3]-3*in[3][2][0]+9*in[3][2][1]-9*in[3][2][2]+3*in[3][2][3]+in[3][3][0]-3*in[3][3][1]+
				3*in[3][3][2]-in[3][3][3])/216;
	
	coefficients[2][0][0] = (in[0][1][1]-2*in[1][1][1]+in[2][1][1])/2;
	
	coefficients[2][0][1] = (-2*in[0][1][0]-3*in[0][1][1]+6*in[0][1][2]-in[0][1][3]+4*in[1][1][0]+6*in[1][1][1]-
				12*in[1][1][2]+2*in[1][1][3]-2*in[2][1][0]-3*in[2][1][1]+6*in[2][1][2]-in[2][1][3])/12;
	
	coefficients[2][0][2] = (in[0][1][0]-2*in[0][1][1]+in[0][1][2]-2*in[1][1][0]+4*in[1][1][1]-2*in[1][1][2]+in[2][1][0]-
				2*in[2][1][1]+in[2][1][2])/4;
	
	coefficients[2][0][3] = (-in[0][1][0]+3*in[0][1][1]-3*in[0][1][2]+in[0][1][3]+2*in[1][1][0]-6*in[1][1][1]+
				6*in[1][1][2]-2*in[1][1][3]-in[2][1][0]+3*in[2][1][1]-3*in[2][1][2]+in[2][1][3])/12;
	
	coefficients[2][1][0] = (-2*in[0][0][1]-3*in[0][1][1]+6*in[0][2][1]-in[0][3][1]+4*in[1][0][1]+6*in[1][1][1]-
				12*in[1][2][1]+2*in[1][3][1]-2*in[2][0][1]-3*in[2][1][1]+6*in[2][2][1]-in[2][3][1])/12;
	
	coefficients[2][1][1] = (4*in[0][0][0]+6*in[0][0][1]-12*in[0][0][2]+2*in[0][0][3]+6*in[0][1][0]+9*in[0][1][1]-
				18*in[0][1][2]+3*in[0][1][3]-12*in[0][2][0]-18*in[0][2][1]+36*in[0][2][2]-6*in[0][2][3]+
				2*in[0][3][0]+3*in[0][3][1]-6*in[0][3][2]+in[0][3][3]-8*in[1][0][0]-12*in[1][0][1]+24*in[1][0][2]-
				4*in[1][0][3]-12*in[1][1][0]-18*in[1][1][1]+36*in[1][1][2]-6*in[1][1][3]+24*in[1][2][0]+
				36*in[1][2][1]-72*in[1][2][2]+12*in[1][2][3]-4*in[1][3][0]-6*in[1][3][1]+12*in[1][3][2]-
				2*in[1][3][3]+4*in[2][0][0]+6*in[2][0][1]-12*in[2][0][2]+2*in[2][0][3]+6*in[2][1][0]+
				9*in[2][1][1]-18*in[2][1][2]+3*in[2][1][3]-12*in[2][2][0]-18*in[2][2][1]+36*in[2][2][2]-
				6*in[2][2][3]+2*in[2][3][0]+3*in[2][3][1]-6*in[2][3][2]+in[2][3][3])/72;
	
	coefficients[2][1][2] = (-2*in[0][0][0]+4*in[0][0][1]-2*in[0][0][2]-3*in[0][1][0]+6*in[0][1][1]-3*in[0][1][2]+
				6*in[0][2][0]-12*in[0][2][1]+6*in[0][2][2]-in[0][3][0]+2*in[0][3][1]-in[0][3][2]+4*in[1][0][0]-
				8*in[1][0][1]+4*in[1][0][2]+6*in[1][1][0]-12*in[1][1][1]+6*in[1][1][2]-12*in[1][2][0]+
				24*in[1][2][1]-12*in[1][2][2]+2*in[1][3][0]-4*in[1][3][1]+2*in[1][3][2]-2*in[2][0][0]+
				4*in[2][0][1]-2*in[2][0][2]-3*in[2][1][0]+6*in[2][1][1]-3*in[2][1][2]+6*in[2][2][0]-
				12*in[2][2][1]+6*in[2][2][2]-in[2][3][0]+2*in[2][3][1]-in[2][3][2])/24;
	
	coefficients[2][1][3] = (2*in[0][0][0]-6*in[0][0][1]+6*in[0][0][2]-2*in[0][0][3]+3*in[0][1][0]-9*in[0][1][1]+
				9*in[0][1][2]-3*in[0][1][3]-6*in[0][2][0]+18*in[0][2][1]-18*in[0][2][2]+6*in[0][2][3]+in[0][3][0]-
				3*in[0][3][1]+3*in[0][3][2]-in[0][3][3]-4*in[1][0][0]+12*in[1][0][1]-12*in[1][0][2]+4*in[1][0][3]-
				6*in[1][1][0]+18*in[1][1][1]-18*in[1][1][2]+6*in[1][1][3]+12*in[1][2][0]-36*in[1][2][1]+
				36*in[1][2][2]-12*in[1][2][3]-2*in[1][3][0]+6*in[1][3][1]-6*in[1][3][2]+2*in[1][3][3]+
				2*in[2][0][0]-6*in[2][0][1]+6*in[2][0][2]-2*in[2][0][3]+3*in[2][1][0]-9*in[2][1][1]+9*in[2][1][2]-
				3*in[2][1][3]-6*in[2][2][0]+18*in[2][2][1]-18*in[2][2][2]+6*in[2][2][3]+in[2][3][0]-3*in[2][3][1]+
				3*in[2][3][2]-in[2][3][3])/72;
	
	coefficients[2][2][0] = (in[0][0][1]-2*in[0][1][1]+in[0][2][1]-2*in[1][0][1]+4*in[1][1][1]-2*in[1][2][1]+in[2][0][1]-
				2*in[2][1][1]+in[2][2][1])/4;
	
	coefficients[2][2][1] = (-2*in[0][0][0]-3*in[0][0][1]+6*in[0][0][2]-in[0][0][3]+4*in[0][1][0]+6*in[0][1][1]-
				12*in[0][1][2]+2*in[0][1][3]-2*in[0][2][0]-3*in[0][2][1]+6*in[0][2][2]-in[0][2][3]+4*in[1][0][0]+
				6*in[1][0][1]-12*in[1][0][2]+2*in[1][0][3]-8*in[1][1][0]-12*in[1][1][1]+24*in[1][1][2]-
				4*in[1][1][3]+4*in[1][2][0]+6*in[1][2][1]-12*in[1][2][2]+2*in[1][2][3]-2*in[2][0][0]-
				3*in[2][0][1]+6*in[2][0][2]-in[2][0][3]+4*in[2][1][0]+6*in[2][1][1]-12*in[2][1][2]+2*in[2][1][3]-
				2*in[2][2][0]-3*in[2][2][1]+6*in[2][2][2]-in[2][2][3])/24;
	
	coefficients[2][2][2] = (in[0][0][0]-2*in[0][0][1]+in[0][0][2]-2*in[0][1][0]+4*in[0][1][1]-2*in[0][1][2]+in[0][2][0]-
				2*in[0][2][1]+in[0][2][2]-2*in[1][0][0]+4*in[1][0][1]-2*in[1][0][2]+4*in[1][1][0]-8*in[1][1][1]+
				4*in[1][1][2]-2*in[1][2][0]+4*in[1][2][1]-2*in[1][2][2]+in[2][0][0]-2*in[2][0][1]+in[2][0][2]-
				2*in[2][1][0]+4*in[2][1][1]-2*in[2][1][2]+in[2][2][0]-2*in[2][2][1]+in[2][2][2])/8;
	
	coefficients[2][2][3] = (-in[0][0][0]+3*in[0][0][1]-3*in[0][0][2]+in[0][0][3]+2*in[0][1][0]-6*in[0][1][1]+
				6*in[0][1][2]-2*in[0][1][3]-in[0][2][0]+3*in[0][2][1]-3*in[0][2][2]+in[0][2][3]+2*in[1][0][0]-
				6*in[1][0][1]+6*in[1][0][2]-2*in[1][0][3]-4*in[1][1][0]+12*in[1][1][1]-12*in[1][1][2]+
				4*in[1][1][3]+2*in[1][2][0]-6*in[1][2][1]+6*in[1][2][2]-2*in[1][2][3]-in[2][0][0]+3*in[2][0][1]-
				3*in[2][0][2]+in[2][0][3]+2*in[2][1][0]-6*in[2][1][1]+6*in[2][1][2]-2*in[2][1][3]-in[2][2][0]+
				3*in[2][2][1]-3*in[2][2][2]+in[2][2][3])/24;
	
	coefficients[2][3][0] = (-in[0][0][1]+3*in[0][1][1]-3*in[0][2][1]+in[0][3][1]+2*in[1][0][1]-6*in[1][1][1]+
				6*in[1][2][1]-2*in[1][3][1]-in[2][0][1]+3*in[2][1][1]-3*in[2][2][1]+in[2][3][1])/12;
	
	coefficients[2][3][1] = (2*in[0][0][0]+3*in[0][0][1]-6*in[0][0][2]+in[0][0][3]-6*in[0][1][0]-9*in[0][1][1]+
				18*in[0][1][2]-3*in[0][1][3]+6*in[0][2][0]+9*in[0][2][1]-18*in[0][2][2]+3*in[0][2][3]-
				2*in[0][3][0]-3*in[0][3][1]+6*in[0][3][2]-in[0][3][3]-4*in[1][0][0]-6*in[1][0][1]+12*in[1][0][2]-
				2*in[1][0][3]+12*in[1][1][0]+18*in[1][1][1]-36*in[1][1][2]+6*in[1][1][3]-12*in[1][2][0]-
				18*in[1][2][1]+36*in[1][2][2]-6*in[1][2][3]+4*in[1][3][0]+6*in[1][3][1]-12*in[1][3][2]+
				2*in[1][3][3]+2*in[2][0][0]+3*in[2][0][1]-6*in[2][0][2]+in[2][0][3]-6*in[2][1][0]-9*in[2][1][1]+
				18*in[2][1][2]-3*in[2][1][3]+6*in[2][2][0]+9*in[2][2][1]-18*in[2][2][2]+3*in[2][2][3]-
				2*in[2][3][0]-3*in[2][3][1]+6*in[2][3][2]-in[2][3][3])/72;
	
	coefficients[2][3][2] = (-in[0][0][0]+2*in[0][0][1]-in[0][0][2]+3*in[0][1][0]-6*in[0][1][1]+3*in[0][1][2]-
				3*in[0][2][0]+6*in[0][2][1]-3*in[0][2][2]+in[0][3][0]-2*in[0][3][1]+in[0][3][2]+2*in[1][0][0]-
				4*in[1][0][1]+2*in[1][0][2]-6*in[1][1][0]+12*in[1][1][1]-6*in[1][1][2]+6*in[1][2][0]-
				12*in[1][2][1]+6*in[1][2][2]-2*in[1][3][0]+4*in[1][3][1]-2*in[1][3][2]-in[2][0][0]+2*in[2][0][1]-
				in[2][0][2]+3*in[2][1][0]-6*in[2][1][1]+3*in[2][1][2]-3*in[2][2][0]+6*in[2][2][1]-3*in[2][2][2]+
				in[2][3][0]-2*in[2][3][1]+in[2][3][2])/24;
	
	coefficients[2][3][3] = (in[0][0][0]-3*in[0][0][1]+3*in[0][0][2]-in[0][0][3]-3*in[0][1][0]+9*in[0][1][1]-9*in[0][1][2]+
				3*in[0][1][3]+3*in[0][2][0]-9*in[0][2][1]+9*in[0][2][2]-3*in[0][2][3]-in[0][3][0]+3*in[0][3][1]-
				3*in[0][3][2]+in[0][3][3]-2*in[1][0][0]+6*in[1][0][1]-6*in[1][0][2]+2*in[1][0][3]+6*in[1][1][0]-
				18*in[1][1][1]+18*in[1][1][2]-6*in[1][1][3]-6*in[1][2][0]+18*in[1][2][1]-18*in[1][2][2]+
				6*in[1][2][3]+2*in[1][3][0]-6*in[1][3][1]+6*in[1][3][2]-2*in[1][3][3]+in[2][0][0]-3*in[2][0][1]+
				3*in[2][0][2]-in[2][0][3]-3*in[2][1][0]+9*in[2][1][1]-9*in[2][1][2]+3*in[2][1][3]+3*in[2][2][0]-
				9*in[2][2][1]+9*in[2][2][2]-3*in[2][2][3]-in[2][3][0]+3*in[2][3][1]-3*in[2][3][2]+in[2][3][3])/72;
	
	coefficients[3][0][0] = (-in[0][1][1]+3*in[1][1][1]-3*in[2][1][1]+in[3][1][1])/6;
	
	coefficients[3][0][1] = (2*in[0][1][0]+3*in[0][1][1]-6*in[0][1][2]+in[0][1][3]-6*in[1][1][0]-9*in[1][1][1]+
				18*in[1][1][2]-3*in[1][1][3]+6*in[2][1][0]+9*in[2][1][1]-18*in[2][1][2]+3*in[2][1][3]-
				2*in[3][1][0]-3*in[3][1][1]+6*in[3][1][2]-in[3][1][3])/36;
	
	coefficients[3][0][2] = (-in[0][1][0]+2*in[0][1][1]-in[0][1][2]+3*in[1][1][0]-6*in[1][1][1]+3*in[1][1][2]-
				3*in[2][1][0]+6*in[2][1][1]-3*in[2][1][2]+in[3][1][0]-2*in[3][1][1]+in[3][1][2])/12;
	
	coefficients[3][0][3] = (in[0][1][0]-3*in[0][1][1]+3*in[0][1][2]-in[0][1][3]-3*in[1][1][0]+9*in[1][1][1]-9*in[1][1][2]+
				3*in[1][1][3]+3*in[2][1][0]-9*in[2][1][1]+9*in[2][1][2]-3*in[2][1][3]-in[3][1][0]+3*in[3][1][1]-
				3*in[3][1][2]+in[3][1][3])/36;
	
	coefficients[3][1][0] = (2*in[0][0][1]+3*in[0][1][1]-6*in[0][2][1]+in[0][3][1]-6*in[1][0][1]-9*in[1][1][1]+
				18*in[1][2][1]-3*in[1][3][1]+6*in[2][0][1]+9*in[2][1][1]-18*in[2][2][1]+3*in[2][3][1]-
				2*in[3][0][1]-3*in[3][1][1]+6*in[3][2][1]-in[3][3][1])/36;
	
	coefficients[3][1][1] = (-4*in[0][0][0]-6*in[0][0][1]+12*in[0][0][2]-2*in[0][0][3]-6*in[0][1][0]-
				9*in[0][1][1]+18*in[0][1][2]-3*in[0][1][3]+12*in[0][2][0]+18*in[0][2][1]-36*in[0][2][2]+
				6*in[0][2][3]-2*in[0][3][0]-3*in[0][3][1]+6*in[0][3][2]-in[0][3][3]+12*in[1][0][0]+18*in[1][0][1]-
				36*in[1][0][2]+6*in[1][0][3]+18*in[1][1][0]+27*in[1][1][1]-54*in[1][1][2]+9*in[1][1][3]-
				36*in[1][2][0]-54*in[1][2][1]+108*in[1][2][2]-18*in[1][2][3]+6*in[1][3][0]+9*in[1][3][1]-
				18*in[1][3][2]+3*in[1][3][3]-12*in[2][0][0]-18*in[2][0][1]+36*in[2][0][2]-6*in[2][0][3]-
				18*in[2][1][0]-27*in[2][1][1]+54*in[2][1][2]-9*in[2][1][3]+36*in[2][2][0]+54*in[2][2][1]-
				108*in[2][2][2]+18*in[2][2][3]-6*in[2][3][0]-9*in[2][3][1]+18*in[2][3][2]-3*in[2][3][3]+
				4*in[3][0][0]+6*in[3][0][1]-12*in[3][0][2]+2*in[3][0][3]+6*in[3][1][0]+9*in[3][1][1]-
				18*in[3][1][2]+3*in[3][1][3]-12*in[3][2][0]-18*in[3][2][1]+36*in[3][2][2]-6*in[3][2][3]+
				2*in[3][3][0]+3*in[3][3][1]-6*in[3][3][2]+in[3][3][3])/216;
	
	coefficients[3][1][2] = (2*in[0][0][0]-4*in[0][0][1]+2*in[0][0][2]+3*in[0][1][0]-6*in[0][1][1]+3*in[0][1][2]-
				6*in[0][2][0]+12*in[0][2][1]-6*in[0][2][2]+in[0][3][0]-2*in[0][3][1]+in[0][3][2]-6*in[1][0][0]+
				12*in[1][0][1]-6*in[1][0][2]-9*in[1][1][0]+18*in[1][1][1]-9*in[1][1][2]+18*in[1][2][0]-
				36*in[1][2][1]+18*in[1][2][2]-3*in[1][3][0]+6*in[1][3][1]-3*in[1][3][2]+6*in[2][0][0]-
				12*in[2][0][1]+6*in[2][0][2]+9*in[2][1][0]-18*in[2][1][1]+9*in[2][1][2]-18*in[2][2][0]+
				36*in[2][2][1]-18*in[2][2][2]+3*in[2][3][0]-6*in[2][3][1]+3*in[2][3][2]-2*in[3][0][0]+
				4*in[3][0][1]-2*in[3][0][2]-3*in[3][1][0]+6*in[3][1][1]-3*in[3][1][2]+6*in[3][2][0]-
				12*in[3][2][1]+6*in[3][2][2]-in[3][3][0]+2*in[3][3][1]-in[3][3][2])/72;
	
	coefficients[3][1][3] = (-2*in[0][0][0]+6*in[0][0][1]-6*in[0][0][2]+2*in[0][0][3]-3*in[0][1][0]+9*in[0][1][1]-
				9*in[0][1][2]+3*in[0][1][3]+6*in[0][2][0]-18*in[0][2][1]+18*in[0][2][2]-6*in[0][2][3]-in[0][3][0]+
				3*in[0][3][1]-3*in[0][3][2]+in[0][3][3]+6*in[1][0][0]-18*in[1][0][1]+18*in[1][0][2]-6*in[1][0][3]+
				9*in[1][1][0]-27*in[1][1][1]+27*in[1][1][2]-9*in[1][1][3]-18*in[1][2][0]+54*in[1][2][1]-
				54*in[1][2][2]+18*in[1][2][3]+3*in[1][3][0]-9*in[1][3][1]+9*in[1][3][2]-3*in[1][3][3]-
				6*in[2][0][0]+18*in[2][0][1]-18*in[2][0][2]+6*in[2][0][3]-9*in[2][1][0]+27*in[2][1][1]-
				27*in[2][1][2]+9*in[2][1][3]+18*in[2][2][0]-54*in[2][2][1]+54*in[2][2][2]-18*in[2][2][3]-
				3*in[2][3][0]+9*in[2][3][1]-9*in[2][3][2]+3*in[2][3][3]+2*in[3][0][0]-6*in[3][0][1]+6*in[3][0][2]-
				2*in[3][0][3]+3*in[3][1][0]-9*in[3][1][1]+9*in[3][1][2]-3*in[3][1][3]-6*in[3][2][0]+
				18*in[3][2][1]-18*in[3][2][2]+6*in[3][2][3]+in[3][3][0]-3*in[3][3][1]+3*in[3][3][2]-in[3][3][3])/216;
	
	coefficients[3][2][0] = (-in[0][0][1]+2*in[0][1][1]-in[0][2][1]+3*in[1][0][1]-6*in[1][1][1]+3*in[1][2][1]-
				3*in[2][0][1]+6*in[2][1][1]-3*in[2][2][1]+in[3][0][1]-2*in[3][1][1]+in[3][2][1])/12;
	
	coefficients[3][2][1] = (2*in[0][0][0]+3*in[0][0][1]-6*in[0][0][2]+in[0][0][3]-4*in[0][1][0]-6*in[0][1][1]+
				12*in[0][1][2]-2*in[0][1][3]+2*in[0][2][0]+3*in[0][2][1]-6*in[0][2][2]+in[0][2][3]-6*in[1][0][0]-
				9*in[1][0][1]+18*in[1][0][2]-3*in[1][0][3]+12*in[1][1][0]+18*in[1][1][1]-36*in[1][1][2]+
				6*in[1][1][3]-6*in[1][2][0]-9*in[1][2][1]+18*in[1][2][2]-3*in[1][2][3]+6*in[2][0][0]+
				9*in[2][0][1]-18*in[2][0][2]+3*in[2][0][3]-12*in[2][1][0]-18*in[2][1][1]+36*in[2][1][2]-
				6*in[2][1][3]+6*in[2][2][0]+9*in[2][2][1]-18*in[2][2][2]+3*in[2][2][3]-2*in[3][0][0]-
				3*in[3][0][1]+6*in[3][0][2]-in[3][0][3]+4*in[3][1][0]+6*in[3][1][1]-12*in[3][1][2]+2*in[3][1][3]-
				2*in[3][2][0]-3*in[3][2][1]+6*in[3][2][2]-in[3][2][3])/72;
	
	coefficients[3][2][2] = (-in[0][0][0]+2*in[0][0][1]-in[0][0][2]+2*in[0][1][0]-4*in[0][1][1]+2*in[0][1][2]-in[0][2][0]+
				2*in[0][2][1]-in[0][2][2]+3*in[1][0][0]-6*in[1][0][1]+3*in[1][0][2]-6*in[1][1][0]+12*in[1][1][1]-
				6*in[1][1][2]+3*in[1][2][0]-6*in[1][2][1]+3*in[1][2][2]-3*in[2][0][0]+6*in[2][0][1]-3*in[2][0][2]+
				6*in[2][1][0]-12*in[2][1][1]+6*in[2][1][2]-3*in[2][2][0]+6*in[2][2][1]-3*in[2][2][2]+in[3][0][0]-
				2*in[3][0][1]+in[3][0][2]-2*in[3][1][0]+4*in[3][1][1]-2*in[3][1][2]+in[3][2][0]-2*in[3][2][1]+
				in[3][2][2])/24;
	
	coefficients[3][2][3] = (in[0][0][0]-3*in[0][0][1]+3*in[0][0][2]-in[0][0][3]-2*in[0][1][0]+6*in[0][1][1]-6*in[0][1][2]+
				2*in[0][1][3]+in[0][2][0]-3*in[0][2][1]+3*in[0][2][2]-in[0][2][3]-3*in[1][0][0]+9*in[1][0][1]-
				9*in[1][0][2]+3*in[1][0][3]+6*in[1][1][0]-18*in[1][1][1]+18*in[1][1][2]-6*in[1][1][3]-
				3*in[1][2][0]+9*in[1][2][1]-9*in[1][2][2]+3*in[1][2][3]+3*in[2][0][0]-9*in[2][0][1]+9*in[2][0][2]-
				3*in[2][0][3]-6*in[2][1][0]+18*in[2][1][1]-18*in[2][1][2]+6*in[2][1][3]+3*in[2][2][0]-
				9*in[2][2][1]+9*in[2][2][2]-3*in[2][2][3]-in[3][0][0]+3*in[3][0][1]-3*in[3][0][2]+in[3][0][3]+
				2*in[3][1][0]-6*in[3][1][1]+6*in[3][1][2]-2*in[3][1][3]-in[3][2][0]+3*in[3][2][1]-3*in[3][2][2]+
				in[3][2][3])/72;
	
	coefficients[3][3][0] = (in[0][0][1]-3*in[0][1][1]+3*in[0][2][1]-in[0][3][1]-3*in[1][0][1]+9*in[1][1][1]-9*in[1][2][1]+
				3*in[1][3][1]+3*in[2][0][1]-9*in[2][1][1]+9*in[2][2][1]-3*in[2][3][1]-in[3][0][1]+3*in[3][1][1]-
				3*in[3][2][1]+in[3][3][1])/36;
	
	coefficients[3][3][1] = (-2*in[0][0][0]-3*in[0][0][1]+6*in[0][0][2]-in[0][0][3]+6*in[0][1][0]+9*in[0][1][1]-
				18*in[0][1][2]+3*in[0][1][3]-6*in[0][2][0]-9*in[0][2][1]+18*in[0][2][2]-3*in[0][2][3]+
				2*in[0][3][0]+3*in[0][3][1]-6*in[0][3][2]+in[0][3][3]+6*in[1][0][0]+9*in[1][0][1]-18*in[1][0][2]+
				3*in[1][0][3]-18*in[1][1][0]-27*in[1][1][1]+54*in[1][1][2]-9*in[1][1][3]+18*in[1][2][0]+
				27*in[1][2][1]-54*in[1][2][2]+9*in[1][2][3]-6*in[1][3][0]-9*in[1][3][1]+18*in[1][3][2]-
				3*in[1][3][3]-6*in[2][0][0]-9*in[2][0][1]+18*in[2][0][2]-3*in[2][0][3]+18*in[2][1][0]+
				27*in[2][1][1]-54*in[2][1][2]+9*in[2][1][3]-18*in[2][2][0]-27*in[2][2][1]+54*in[2][2][2]-
				9*in[2][2][3]+6*in[2][3][0]+9*in[2][3][1]-18*in[2][3][2]+3*in[2][3][3]+2*in[3][0][0]+
				3*in[3][0][1]-6*in[3][0][2]+in[3][0][3]-6*in[3][1][0]-9*in[3][1][1]+18*in[3][1][2]-3*in[3][1][3]+
				6*in[3][2][0]+9*in[3][2][1]-18*in[3][2][2]+3*in[3][2][3]-2*in[3][3][0]-3*in[3][3][1]+
				6*in[3][3][2]-in[3][3][3])/216;
		
	coefficients[3][3][2] = (in[0][0][0]-2*in[0][0][1]+in[0][0][2]-3*in[0][1][0]+6*in[0][1][1]-3*in[0][1][2]+3*in[0][2][0]-
				6*in[0][2][1]+3*in[0][2][2]-in[0][3][0]+2*in[0][3][1]-in[0][3][2]-3*in[1][0][0]+6*in[1][0][1]-
				3*in[1][0][2]+9*in[1][1][0]-18*in[1][1][1]+9*in[1][1][2]-9*in[1][2][0]+18*in[1][2][1]-
				9*in[1][2][2]+3*in[1][3][0]-6*in[1][3][1]+3*in[1][3][2]+3*in[2][0][0]-6*in[2][0][1]+3*in[2][0][2]-
				9*in[2][1][0]+18*in[2][1][1]-9*in[2][1][2]+9*in[2][2][0]-18*in[2][2][1]+9*in[2][2][2]-
				3*in[2][3][0]+6*in[2][3][1]-3*in[2][3][2]-in[3][0][0]+2*in[3][0][1]-in[3][0][2]+3*in[3][1][0]-
				6*in[3][1][1]+3*in[3][1][2]-3*in[3][2][0]+6*in[3][2][1]-3*in[3][2][2]+in[3][3][0]-2*in[3][3][1]+
				in[3][3][2])/72;
	
	coefficients[3][3][3] = (-in[0][0][0]+3*in[0][0][1]-3*in[0][0][2]+in[0][0][3]+3*in[0][1][0]-9*in[0][1][1]+
				9*in[0][1][2]-3*in[0][1][3]-3*in[0][2][0]+9*in[0][2][1]-9*in[0][2][2]+3*in[0][2][3]+in[0][3][0]-
				3*in[0][3][1]+3*in[0][3][2]-in[0][3][3]+3*in[1][0][0]-9*in[1][0][1]+9*in[1][0][2]-3*in[1][0][3]-
				9*in[1][1][0]+27*in[1][1][1]-27*in[1][1][2]+9*in[1][1][3]+9*in[1][2][0]-27*in[1][2][1]+
				27*in[1][2][2]-9*in[1][2][3]-3*in[1][3][0]+9*in[1][3][1]-9*in[1][3][2]+3*in[1][3][3]-
				3*in[2][0][0]+9*in[2][0][1]-9*in[2][0][2]+3*in[2][0][3]+9*in[2][1][0]-27*in[2][1][1]+
				27*in[2][1][2]-9*in[2][1][3]-9*in[2][2][0]+27*in[2][2][1]-27*in[2][2][2]+9*in[2][2][3]+
				3*in[2][3][0]-9*in[2][3][1]+9*in[2][3][2]-3*in[2][3][3]+in[3][0][0]-3*in[3][0][1]+3*in[3][0][2]-
				in[3][0][3]-3*in[3][1][0]+9*in[3][1][1]-9*in[3][1][2]+3*in[3][1][3]+3*in[3][2][0]-9*in[3][2][1]+
				9*in[3][2][2]-3*in[3][2][3]-in[3][3][0]+3*in[3][3][1]-3*in[3][3][2]+in[3][3][3])/216;
	
	for (i=0;i<step+1;i++){
		x = cell[0]+(double)i/(double)step;
		for (j=0;j<step+1;j++){
			y = cell[1]+(double)j/(double)step;
			for (k=0;k<step+1;k++){
				z = cell[2]+(double)k/(double)step;
				out[i][j][k] = function(coefficients, x, y, z);
			}
		}
	}
	
	
	return 0;	
}

double function(double ***coefficients, double x, double y, double z){

	double pt = 0.0;
	double xvec[4];
	double yvec[4];
	double zvec[4];
	int i,j,k;
	
	xvec[0] = 1;
	xvec[1] = x;
	xvec[2] = x*x;
	xvec[3] = x*x*x;
	
	yvec[0] = 1;
	yvec[1] = y;
	yvec[2] = y*y;
	yvec[3] = y*y*y;
	
	zvec[0] = 1;
	zvec[1] = z;
	zvec[2] = z*z;
	zvec[3] = z*z*z;
	
	for (i=0;i<4;i++){
		for (j=0;j<4;j++){
			for (k=0;k<4;k++){
				pt += coefficients[i][j][k]*xvec[i]*yvec[j]*zvec[k];
			}
		}
	}
	
	return pt;
}
